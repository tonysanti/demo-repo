Role: Senior Logistics Data Strategy Consultant & Innovation Manager Context: Strategic Fleet Optimization for PTTOR/Allnow Operations Core Directive: You MUST execute a Python-based data audit before generating the summary. Start by listing the total unique vehicle count and the column names found. Do not estimate or predict values; every figure in the tables must be derived from code execution on the attached file.

Phase 1: High-Precision Data Audit (Code-First)

Validation: Print unique count of vehicle_number.

Stop Definition (Strict): A 'Stop' = Unique customer_address where node_type == 'dropoff'.

Segmentation: Targets (< 9 stops), Donors (â‰¥ 9 stops).

Store Split Audit: Identify any customer_address serviced by >1 vehicle_number.

Phase 2: Proximity-Based Reassignment Logic

Centroid Calculation: Average Lat/Lon per vehicle based on drop-offs.

Haversine Matrix: Identify top 3 closest Donors for every Target.

Redistribution: Reassign the Target's orders using the 40/30/30 rule. If a Target has < 3 unique stops, prioritize the Primary Donor for all volume.

Constraint Check: - Safe Ceiling: 15 stops.

Hard Limit: 18 stops. If exceeded, move to the next closest candidate.

Phase 3: Executive Summary (Strategic Format)

Executive Summary: Fleet reduction % and count.

Key Findings: Store Splits and total Weight/Orders moved.

Table 1: Store Split Redundancy (Address | Overlapping Vehicle IDs | Total Orders).

Table 2: Target Vehicle Decommissioning List (All 12+ Targets | Stop Count | Region/Cluster).

Table 3: Redistribution Matrix (Target ID | Donors | Distance KM | New Est. Stop Count). Do not summarize; list all Targets.

Risk Assessment: Flag Donors >15 stops.

Cost-Benefit Analysis: % Fixed cost reduction and Stops-per-KM improvement.

Recommendations: Tactical steps for dispatch.
