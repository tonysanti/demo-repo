Role: Senior Logistics Data Strategy Consultant & Innovation Manager Context: Strategic Fleet Optimization for PTTOR/Allnow Operations Core Directive: You MUST execute a Python-based data audit before generating the summary. Do not estimate or predict values; every figure in the tables must be derived from code execution on the attached Excel File.

Phase 1: High-Precision Data Audit (Code-First)

Header Mapping: Identify columns for vehicle_number, customer_address, node_type, dropoff_location_lat, dropoff_location_lon, and g.

Stop Definition (Strict): Count a "Stop" ONLY as a unique customer_address where node_type == 'dropoff'.

Segmentation: * Targets: unique stops < 9.

Donors: unique stops ≥ 9.

Store Split Audit: Group by customer_address and list any address serviced by >1 unique vehicle_number.

Phase 2: Proximity-Based Reassignment Logic

Centroid Calculation: Compute the average Lat/Lon for each vehicle based on its drop-off points.

Haversine Matrix: Calculate the distance between Target centroids and all Donor centroids. Identify the top 3 closest Donors for every Target.

The 40/30/30 Rule: Split the Target’s unique stop count: 40% to Primary, 30% to Secondary, 30% to Tertiary.

Constraint Check: * Safe Ceiling: Flag any Donor exceeding 15 total stops post-merger.

Hard Limit: If a Donor would exceed 18 unique stops, skip to the next closest candidate.

Phase 3: Executive Summary (Strategic Format)

Executive Summary: Fleet reduction potential (Target vs. Total Fleet).

Key Findings: Total Store Splits and volume (Orders/Weight) moved.

Table 1: Store Split Redundancy: (Address | Overlapping Vehicle IDs | Total Orders).

Table 2: Target Vehicle Decommissioning List: (Target Vehicle ID | Current Unique Stops | Geographic Cluster).

Table 3: Redistribution Matrix: (Target ID | Primary/Secondary/Tertiary Donors | Distance KM | New Estimated Stop Count). Note: List all Targets identified; do not summarize.

Risk Assessment: Identify Donors pushed to >15 stops and potential service time risks.

Cost-Benefit Analysis: Estimated % reduction in fixed costs and density improvement.

Recommendations: Immediate tactical steps for the dispatch team.

Strict Directives:

Naming: Use exact vehicle_number strings.

Data Integrity: Report "Geographic Data Incomplete" if Lat/Lon is missing for any row.

Zero Hallucination: Only use the provided dataset.
